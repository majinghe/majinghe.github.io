<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Dify + RustFS + Milvus，构建文档多语种翻译 AI Workflow - 小马哥的博客</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="马景贺（小马哥）"><meta name=description content="使用 dify + rustfs + milvus 构建一个 Dify workflow"><meta name=keywords content="Hugo,theme,even"><meta name=generator content="Hugo 0.79.1 with theme even"><link rel=canonical href=https://majinghe.github.io/aigc/dify/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=/sass/main.min.c7bc1becf36bcf6a9ebd25d2947e43a2eb745ddb0c9a32b43126fd7fa460c351.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="Dify + RustFS + Milvus，构建文档多语种翻译 AI Workflow"><meta property="og:description" content="使用 dify + rustfs + milvus 构建一个 Dify workflow"><meta property="og:type" content="article"><meta property="og:url" content="https://majinghe.github.io/aigc/dify/"><meta property="article:published_time" content="2025-10-03T09:05:42+08:00"><meta property="article:modified_time" content="2025-10-03T09:05:42+08:00"><meta itemprop=name content="Dify + RustFS + Milvus，构建文档多语种翻译 AI Workflow"><meta itemprop=description content="使用 dify + rustfs + milvus 构建一个 Dify workflow"><meta itemprop=datePublished content="2025-10-03T09:05:42+08:00"><meta itemprop=dateModified content="2025-10-03T09:05:42+08:00"><meta itemprop=wordCount content="3589"><meta itemprop=keywords content="AIGC,milvus,RustFS,Dify,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Dify + RustFS + Milvus，构建文档多语种翻译 AI Workflow"><meta name=twitter:description content="使用 dify + rustfs + milvus 构建一个 Dify workflow"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>小马哥</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/cloud-native><li class=mobile-menu-item>Cloud Native</li></a><a href=/devsecops><li class=mobile-menu-item>DevSecOps</li></a><a href=/aigc><li class=mobile-menu-item>AIGC</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><head><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-T0B2C6W2ZH','auto');ga('set','anonymizeIp',true);ga('send','pageview');}</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','G-T0B2C6W2ZH','auto');ga('set','anonymizeIp',true);ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><div class=logo-wrapper><a href=/ class=logo>小马哥</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/cloud-native>Cloud Native</a></li><li class=menu-item><a class=menu-item-link href=/devsecops>DevSecOps</a></li><li class=menu-item><a class=menu-item-link href=/aigc>AIGC</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Dify + RustFS + Milvus，构建文档多语种翻译 AI Workflow</h1><div class=post-meta><span class=post-time>2025-10-03</span><div class=post-category><a href=/categories/aigc/>AIGC</a></div><span class=more-meta>约 3589 字</span>
<span class=more-meta>预计阅读 8 分钟</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>文章目录</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#关于-dify>关于 Dify</a></li><li><a href=#关于-rustfs-和-milvus>关于 RustFS 和 Milvus</a></li><li><a href=#安装-dify>安装 Dify</a><ul><li><a href=#milvus-配置修改>Milvus 配置修改</a></li><li><a href=#minio-配置修改>Minio 配置修改</a></li><li><a href=#安装-dify-1>安装 Dify</a></li></ul></li><li><a href=#构建-dify-workflow>构建 Dify workflow</a><ul><li><a href=#上传文件>上传文件</a></li><li><a href=#读取文件内容>读取文件内容</a></li><li><a href=#用-llm-翻译文档>用 LLM 翻译文档</a></li><li><a href=#将文档上传至-rustfs>将文档上传至 RustFS</a></li><li><a href=#结束>结束</a></li></ul></li><li><a href=#运行-workflow>运行 workflow</a></li><li><a href=#结果验证>结果验证</a></li><li><a href=#结束语>结束语</a></li></ul></li></ul></nav></div></div><div class=post-content><p>本文利用 Dify + RustFS + Milvus 搭建一个文档的多语言翻译 workflow，实现将<strong>将中文文档同时翻译为英语、日语、俄语、韩语</strong>（如果想要，可以随意加）。有了 AI，文档的撰写和多语种翻译从未想过今天这样高效。</p><h2 id=关于-dify>关于 Dify</h2><p>Dify 是一款开源的大语言模型（LLM）应用开发平台。它融合了后端即服务（Backend as Service）和 LLMOps 的理念，使开发者可以快速搭建生产级的生成式 AI 应用。即使你是非技术人员，也能参与到 AI 应用的定义和数据运营过程中。目前 Dify 在 GitHub 上的 Star 已经超过 <strong>116k</strong>。</p><h2 id=关于-rustfs-和-milvus>关于 RustFS 和 Milvus</h2><p>关于 RustFS 和 Milvus 可以查阅过往的博客文章：</p><ul><li><a href=../milvus/index.md>Milvus + RustFS + Vibe Coding，快速 DIY 一个 Chatbot</a></li><li><a href=../rustfs-mcp/index.md>新一代对象存储 RustFS 的 MCP 扩展实践</a></li></ul><h2 id=安装-dify>安装 Dify</h2><p>Dify 官方提供了 <a href=https://github.com/langgenius/dify/blob/main/docker/docker-compose.yaml><code>docker-compose.yaml</code></a>来通过 Docker Compose 的方式私有化部署一个 Dify 实例。官方也提供了这种安装模式下各组件的架构示意图：</p><p><img src=./images/docker-compose.png alt="dify docker compose"></p><p>由架构图中看到，Dify 会将向量数据存储向量数据库，而且官方支持多款向量数据库，诸如 <code>weaviate</code>、<code>qdrant</code>、<code>opensearch</code>、<code>miluvs</code> 等。需要通过 <code>VECTOR_STORE</code> 来指定使用的向量数据库。本次实践使用 <code>milvus</code>，需要对 <code>docker-compose.yaml</code> 文件做一些变更。</p><h3 id=milvus-配置修改>Milvus 配置修改</h3><p>修改的配置如下：</p><ul><li>*指定使用 milvus 向量数据库</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>VECTOR_STORE: ${VECTOR_STORE:-milvus}
</code></pre></td></tr></table></div></div><ul><li>*镜像更换</li></ul><p>，将当前官方默认的 2.5.15 替换为 2.6.0 或 2.6.2</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>image: milvusdb/milvus:v2.6.0
</code></pre></td></tr></table></div></div><blockquote><p>使用默认的 <code>2.5.15</code> 镜像出现了 IndexNode 19530 端口被占用的问题，更换镜像后问题消失。</p></blockquote><ul><li>修改 milvus 地址</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>MILVUS_URI: ${MILVUS_URI:-http://milvus-standalone:19530}
</code></pre></td></tr></table></div></div><h3 id=minio-配置修改>Minio 配置修改</h3><p>在上一篇文章<a href=../milvus/index.md>Milvus + RustFS + Vibe Coding，快速 DIY 一个 Chatbot</a>中写到了，milvus 支持将 minio 配置为对象存储后端，由于 RustFS 作为 minio 的完全平替，因此可以将 RustFS 配置为 milvus 的对象存储后端，在 <code>docker-compose.yaml</code> 文件中添加如下内容：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>  rustfs:
    container_name: dify-rustfs
    image: rustfs/rustfs:1.0.0-alpha.60
    environment:
      - RUSTFS_VOLUMES=/data/rustfs0,/data/rustfs1,/data/rustfs2,/data/rustfs3
      - RUSTFS_ADDRESS=0.0.0.0:9000
      - RUSTFS_CONSOLE_ADDRESS=0.0.0.0:9001
      - RUSTFS_CONSOLE_ENABLE=true
      - RUSTFS_EXTERNAL_ADDRESS=:9000
      - RUSTFS_CORS_ALLOWED_ORIGINS=*
      - RUSTFS_CONSOLE_CORS_ALLOWED_ORIGINS=*
      - RUSTFS_ACCESS_KEY=rustfsadmin
      - RUSTFS_SECRET_KEY=rustfsadmin
    ports:
      - &#34;9000:9000&#34; # S3 API port
      - &#34;9001:9001&#34; # Console port
    volumes:
      - rustfs_data_0:/data/rustfs0
      - rustfs_data_1:/data/rustfs1
      - rustfs_data_2:/data/rustfs2
      - rustfs_data_3:/data/rustfs3
      - logs_data:/app/logs
    restart: unless-stopped
    healthcheck:
      test:
        [
          &#34;CMD&#34;,
          &#34;sh&#34;, &#34;-c&#34;,
          &#34;apk add curl &amp;&amp; curl -f http://localhost:9001/health&#34;
        ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    networks:
      - milvus
</code></pre></td></tr></table></div></div><p>注释掉与 minio 相关的内容：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>  minio:
    container_name: milvus-minio
    image: minio/minio:RELEASE.2023-03-20T20-16-18Z
    profiles:
      - milvus
    environment:
      MINIO_ACCESS_KEY: ${MINIO_ACCESS_KEY:-minioadmin}
      MINIO_SECRET_KEY: ${MINIO_SECRET_KEY:-minioadmin}
    volumes:
      - ./volumes/milvus/minio:/minio_data
    command: minio server /minio_data --console-address &#34;:9001&#34;
    healthcheck:
      test: [&#34;CMD&#34;, &#34;curl&#34;, &#34;-f&#34;, &#34;http://localhost:9000/minio/health/live&#34;]
      interval: 30s
      timeout: 20s
      retries: 3
    networks:
      - milvus
</code></pre></td></tr></table></div></div><p>更新以下环境变量信息：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>  MINIO_ACCESS_KEY: ${RUSTFS_ACCESS_KEY:-rustfsadmin}
  MINIO_SECRET_KEY: ${RUSTFS_SECRET_KEY:-rustfsadmin}
</code></pre></td></tr></table></div></div><p>同时需要告诉 Dify 使用 S3 存储而不是本地存储：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>STORAGE_TYPE: ${STORAGE_TYPE:-s3}
</code></pre></td></tr></table></div></div><p>将 S3 相关的环境变量信息更改为 RustFS 实例的具体信息：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>  S3_ENDPOINT: ${S3_ENDPOINT:-http://rustfs:9000}
  S3_REGION: ${S3_REGION:-cn-east-1}
  S3_BUCKET_NAME: ${S3_BUCKET_NAME:-difyai}
  S3_ACCESS_KEY: ${S3_ACCESS_KEY:-rustfsadmin}
  S3_SECRET_KEY: ${S3_SECRET_KEY:-rustfsadmin}
  S3_USE_AWS_MANAGED_IAM: ${S3_USE_AWS_MANAGED_IAM:-false}
</code></pre></td></tr></table></div></div><p>需要修改的信息已经整理完毕，下面开始正式安装部署。</p><h3 id=安装-dify-1>安装 Dify</h3><p>将 <a href=https://github.com/langgenius/dify>Dify</a>代码克隆到本地，按照前面步骤中的变更修改 <code>docker-compose.yaml</code> 文件，然后执行如下命令进行安装：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>docker compose -f docker-compose.yaml up -d
</code></pre></td></tr></table></div></div><p>查看安装结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>docker compose ps
NAME                     IMAGE                                       COMMAND                  SERVICE             CREATED      STATUS                            PORTS
dify-rustfs              rustfs/rustfs:1.0.0-alpha.58                &#34;/entrypoint.sh rust…&#34;   rustfs              3 days ago   Up 3 days (healthy)               0.0.0.0:9000-9001-&gt;9000-9001/tcp, [::]:9000-9001-&gt;9000-9001/tcp
docker-api-1             langgenius/dify-api:1.9.0                   &#34;/bin/bash /entrypoi…&#34;   api                 3 days ago   Up 3 days                         0.0.0.0:5001-&gt;5001/tcp, [::]:5001-&gt;5001/tcp
docker-db-1              postgres:15-alpine                          &#34;docker-entrypoint.s…&#34;   db                  3 days ago   Up 3 days (healthy)               5432/tcp
docker-nginx-1           nginx:latest                                &#34;sh -c &#39;cp /docker-e…&#34;   nginx               3 days ago   Up 3 days                         0.0.0.0:80-&gt;80/tcp, [::]:80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp, [::]:443-&gt;443/tcp
docker-plugin_daemon-1   langgenius/dify-plugin-daemon:0.3.0-local   &#34;/bin/bash -c /app/e…&#34;   plugin_daemon       3 days ago   Up 3 days                         0.0.0.0:5003-&gt;5003/tcp, [::]:5003-&gt;5003/tcp
docker-redis-1           redis:6-alpine                              &#34;docker-entrypoint.s…&#34;   redis               3 days ago   Up 3 days (healthy)               6379/tcp
docker-sandbox-1         langgenius/dify-sandbox:0.2.12              &#34;/main&#34;                  sandbox             3 days ago   Up 3 days (healthy)               
docker-ssrf_proxy-1      ubuntu/squid:latest                         &#34;sh -c &#39;cp /docker-e…&#34;   ssrf_proxy          3 days ago   Up 3 days                         3128/tcp
docker-web-1             langgenius/dify-web:1.9.0                   &#34;/bin/sh ./entrypoin…&#34;   web                 3 days ago   Up 3 days                         3000/tcp
docker-worker-1          langgenius/dify-api:1.9.0                   &#34;/bin/bash /entrypoi…&#34;   worker              3 days ago   Up 3 days                         5001/tcp
docker-worker_beat-1     langgenius/dify-api:1.9.0                   &#34;/bin/bash /entrypoi…&#34;   worker_beat         3 days ago   Up 3 days                         5001/tcp
milvus-etcd              quay.io/coreos/etcd:v3.5.5                  &#34;etcd -advertise-cli…&#34;   etcd                3 days ago   Up 3 days (healthy)               2379-2380/tcp
milvus-standalone        milvusdb/milvus:v2.6.0                      &#34;/tini -- milvus run…&#34;   milvus-standalone   3 days ago   Up 4 seconds (health: starting)   0.0.0.0:9091-&gt;9091/tcp, [::]:9091-&gt;9091/tcp, 0.0.0.0:19530-&gt;19530/tcp, [::]:19530-&gt;19530/tcp
</code></pre></td></tr></table></div></div><p>所有服务运行正常后，dify web 页面可通过 <code>localhost/install</code> 访问（如果是在云端服务器安装，可将 <code>localhost</code> 替换为服务器 IP）。</p><p>初始化登录需要设置邮箱地址和密码，设置完毕登录，可看到 Dify web 页面：</p><p><img src=./images/dify-web-ui.png alt="dify web ui"></p><blockquote><p>图中的 docs-trans 不是默认的，是我自己创建的 workflow。</p></blockquote><p>接下来利用 Dify 构建一个 workflow：<strong>将 RustFS 与 milvus 集成的中文文档（一个 Markdown 文件）翻译成英语、日语、俄语以及韩语</strong>。</p><h2 id=构建-dify-workflow>构建 Dify workflow</h2><p>整体流程如下：</p><p><img src=./images/workflow-overview.png alt="docs translation workflow"></p><h3 id=上传文件>上传文件</h3><p>Dify workflow 中支持对文件进行上传，而且支持多种文件格式，包括 <code>TXT</code>、<code>PDF</code>、<code>MARKDOWN</code>、<code>DOCS</code> 等。</p><p>在 Dify Start 节点的 <code>SETTINGS --> INPUT FIELD</code> 中选择文件类型，并选择文件上传方式：</p><p><img src=./images/file-upload.png alt="file upload"></p><p>本次实践使用 <a href=https://docs.rustfs.com/zh/integration/milvus.html>RustFS 和 Milvus 集成的文档</a>，是一个 Markdown 文件，因此文件类型选择 <strong>Document</strong>；上传方式选择 <strong>Local Upload</strong>。</p><h3 id=读取文件内容>读取文件内容</h3><p>由于 LLM 没法直接读取文件内容，所以 Dify 提供了 <a href=https://docs.dify.ai/zh-hans/guides/workflow/node/doc-extractor><strong>文档提取器</strong></a>来读取 Start 节点中上传的内容，然后将其喂给 LLM 进行翻译。</p><p>在 Start 节点后添加一个 <strong>DOC EXTRACTOR</strong> 节点，输入为 Start 节点上传的 Markdown 文件，输出为提取的文本内容（这时候会生成一个 text 变量，后续可引用），这些内容作为下一步，也就是 LLM 的输入，所以在 <strong>DOC EXTRACTOR</strong> 节点的 <strong>NEXT STEP</strong> 中都是 LLM。</p><p><img src=./images/docs-extractor.png alt="docs extractor"></p><h3 id=用-llm-翻译文档>用 LLM 翻译文档</h3><p>Dify 的 LLM 节点可以调用大模型的能力来对上一个节点的输出内容进行操作。而且主流的大模型都支持，可以在 <strong>Web 页面 &ndash;> Plugins</strong> 中搜索可用的大模型，比如此次使用的 DeepSeek：</p><p><img src=./images/llm-search.png alt="llm search"></p><p>选择之后点击 <strong>Install</strong> 即可。</p><p>安装完毕后，要在模型提供商（Model Provider）中配置 API Key，后续才可在 Workflow 中调用：</p><p><img src=./images/mode-provider.png alt="model provider"></p><p>然后添加 LLM 节点：</p><p><img src=./images/llm-configuration.png alt="llm configuration"></p><p>还需要做好以下配置：</p><ul><li><p>在 <strong>MODEL</strong> 下拉菜单中选择想要使用（提前安装且配置了 API Key 的模型才会出现在该列表中），比如此次选择了 <code>DeepSeek</code>；</p></li><li><p>设置好提示词，也就是告诉大模型要做什么事情；比如本次使用的提示词为：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>假设你是一位 RustFS 专家，将下面的内容翻译成英文/日语/俄语/韩语，同样按照 Markdown 格式输出，内容如下：
</code></pre></td></tr></table></div></div><blockquote><p>切记，要在系统提示词中选择上 <strong>DOCS EXTRACTOR</strong> 节点的输出（是一个 text 变量，输入 <code>/</code> 可直接选择）。</p></blockquote></li></ul><p>为每一个 <strong>DOC EXTRACTOR</strong> 都选择了一个 LLM，使用了类似的提示词（唯一的差别就是翻译的语种）。整体配置如下：</p><p><img src=./images/doc-tractor-and-llm.png alt="docs extractor and llm"></p><p>接下来将 LLM 的输出直接上传到 RustFS。</p><blockquote><p>Dify 内置一个 API 服务，可以将上一步的文件作为输出进行预览和下载。这需要调整一下 <code>docker-compose.yaml</code> 文件，为了方便，直接使用现成的 RustFS 实例作为文档的最终输出载体，而且还能体验一下 Dify 的工具功能。</p></blockquote><h3 id=将文档上传至-rustfs>将文档上传至 RustFS</h3><p>Dify 工具节点可以选择不同的工具来对上一个节点的内容进行处理，目前官方支持的工具有三种：</p><ul><li><strong>内置工具</strong>：Dify 第一方提供的工具；</li><li><strong>自定义工具</strong>：用户自己导入或配置的工具；</li><li><strong>工作流</strong>：将编排好的工作流发布为工具来使用）。</li></ul><p>本次实践使用 Dify 提供的内置工具 —— minio 来存储翻译之后的内容。</p><p>工具在使用之前需要先安装，在 Dify Web 首页的 <strong>Tools</strong> 中搜索可用的工具：</p><p><img src=./images/dify-tool-search.png alt="dify tool search"></p><blockquote><p>由于已经安装好了 minio，所以 minio 展现在了最上面，如果未安装，在下面的搜索结果中，点击蓝色的 <strong>install</strong> 按钮即可完成安装。</p></blockquote><p>在节点添加中点击 <strong>Tool</strong> 来选择已经安装好的工具 —— minio：</p><p><img src=./images/dify-tool-selection.png alt="dify tool selection"></p><p>由于是上传文件，所以选择 MINIO_WRITER，然后输入 RustFS 实例相关信息：</p><p><img src=./images/rustfs-info.png alt="rustfs info"></p><p>主要信息：</p><ul><li><strong>MinIO Endpoint URL</strong>：RustFS 实例地址（比如是 <code>localhost:9000</code>）；</li><li><strong>MinIO Access Key</strong>：RustFS Access Key ID（比如默认的 <code>rustfsadmin</code>）；</li><li><strong>MinIO Secret Key</strong>：RustFS Secret Key ID（比如默认的 <code>rustfsadmin</code>）；</li><li><strong>Bucket Name</strong>：存储文件的存储桶名称，须提前在 RustFS 上创建。</li><li><strong>Object Name</strong>：文件上传到存储中之后的对象名称，自定义即可；</li><li><strong>Content</strong>：工具节点的输入，也就是 LLM 节点的输出，选择 <code>text</code> 即可；</li></ul><p>由于本次实践是将中文文档翻译为 4 种不同语言，所以添加了 4 个 MINIO_WRITER 节点：</p><p><img src=./images/four-minio-tool.png alt="four minio tool"></p><h3 id=结束>结束</h3><p>Dify 每个工作流的尾部都要加一个结束节点，正常添加即可。</p><p><img src=./images/dify-end-node.png alt="dify end node"></p><h2 id=运行-workflow>运行 workflow</h2><p>点击右上角的 <strong>Run</strong> 按钮即可开始 workflow 的运行，点击之后在出现的界面中上传需要翻译的中文文档（Markdown 格式），然后点击 <strong>Start Run</strong>：</p><p><img src=./images/run-dify-workflow.png alt="run dify workflow"></p><p>可以在界面上清晰的看到 workflow 的进度：</p><p><img src=./images/dify-workflow-process.png alt="dify workflow process"></p><p>流程全部执行完毕后，可以在所有节点的右上角上看到绿色的通过标志。</p><p><img src=./images/workflow-final-result.png alt="workflow final result"></p><h2 id=结果验证>结果验证</h2><p>本次是将上传的 Markdown 文档（文件名称为 <code>milvus.md</code>）翻译成英语、日语、俄语、韩语，然后分别上传到 RustFS 实例的四个存储桶中：en-translation、jp-translation、ru-translation、kr-translation，每个存储桶中对应有一个对象，分别是：en-milvus.md、jp-milvus.md、ru-milvus.md、kr-milvus.md：</p><p><img src=./images/rustfs-bucket-verify.png alt="rustfs bucket verify"></p><p>存储桶中的存储对象：</p><p><img src=./images/object-check.png alt="bucket check"></p><p>可以直接选择某一个对象文件，点击啊 <strong>Preview</strong> 进行内容查看，比如查看韩语文档：</p><p><img src=./images/object-preview-selection.png alt="object preview"></p><p>内容如下：</p><p><img src=./images/kr-docs-content.png alt="kr docs content"></p><p>可以用类似的方法查看其他语言的文档内容，如果审核无误，可以直接下载，然后进行文档提交。</p><h2 id=结束语>结束语</h2><p>Dify 提供了一种灵活的方式让用户自行构建 AI 应用，整个过程可能就是拖拉拽 + 简单的编程，相比于全程使用 API 来将各种服务或者工具串联起来的纯编程模式，Dify 确实体验更好，不过要想熟练使用 Dify，也需要解决两个问题：</p><ul><li>深度了解 Dify，包括架构和各个功能的使用，这个阅读文档 + 多动手实践就可以；</li><li>用户需要清楚的知道自己想要的 AI 应用或者 workflow 是怎样的，换言之，用户需要知道如何将 AI 能力引入到自己的实际需求中，这种情况下 Dify 才能发挥最大作用；</li></ul><p>另外，minio 作为全球知名的对象存储系统，确实使用广泛，但是完全可以用 RustFS 来对 minio 进行平替。</p><p>Dify workflow 一旦上手，就会想 DIY 各种有趣工作流来优化自己的工作方式。后续还会继续探索 Dify 和其他应用的集成实践。感兴趣的可以关注这个号！</p></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>马景贺（小马哥）</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2025-10-03</span></p></div><footer class=post-footer><div class=post-tags><a href=/tags/aigc/>AIGC</a>
<a href=/tags/milvus/>milvus</a>
<a href=/tags/rustfs/>RustFS</a>
<a href=/tags/dify/>Dify</a></div><nav class=post-nav><a class=next href=/aigc/milvus/><span class="next-text nav-default">Milvus + RustFS + Vibe Coding，快速 DIY 一个 Chatbot</span>
<span class="next-text nav-mobile">下一篇</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=devops008@sina.com class="iconfont icon-email" title=email></a><a href=https://github.com/majinghe class="iconfont icon-github" title=github></a><a href=https://majinghe.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>由 <a class=hexo-link href=https://gohugo.io>Hugo</a> 强力驱动</span>
<span class=division>|</span>
<span class=theme-info>主题 -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020 -
2025<span class=heart><i class="iconfont icon-heart"></i></span><span>olOwOlo</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','G-T0B2C6W2ZH','auto');ga('set','anonymizeIp',true);ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>