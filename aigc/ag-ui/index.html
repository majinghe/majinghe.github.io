<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>MCP、A2A 之外，AI 领域又新增一协议-AG-UI - 小马哥的博客</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="马景贺（小马哥）"><meta name=description content="Agent User Interaction Protocol 解读"><meta name=keywords content="Hugo,theme,even"><meta name=generator content="Hugo 0.79.1 with theme even"><link rel=canonical href=https://majinghe.github.io/aigc/ag-ui/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=/sass/main.min.c7bc1becf36bcf6a9ebd25d2947e43a2eb745ddb0c9a32b43126fd7fa460c351.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="MCP、A2A 之外，AI 领域又新增一协议-AG-UI"><meta property="og:description" content="Agent User Interaction Protocol 解读"><meta property="og:type" content="article"><meta property="og:url" content="https://majinghe.github.io/aigc/ag-ui/"><meta property="article:published_time" content="2025-05-15T10:05:42+08:00"><meta property="article:modified_time" content="2025-05-15T10:05:42+08:00"><meta itemprop=name content="MCP、A2A 之外，AI 领域又新增一协议-AG-UI"><meta itemprop=description content="Agent User Interaction Protocol 解读"><meta itemprop=datePublished content="2025-05-15T10:05:42+08:00"><meta itemprop=dateModified content="2025-05-15T10:05:42+08:00"><meta itemprop=wordCount content="1719"><meta itemprop=keywords content="AI,LLM,"><meta name=twitter:card content="summary"><meta name=twitter:title content="MCP、A2A 之外，AI 领域又新增一协议-AG-UI"><meta name=twitter:description content="Agent User Interaction Protocol 解读"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>小马哥</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/cloud-native><li class=mobile-menu-item>Cloud Native</li></a><a href=/devsecops><li class=mobile-menu-item>DevSecOps</li></a><a href=/aigc><li class=mobile-menu-item>AIGC</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><head><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-T0B2C6W2ZH','auto');ga('set','anonymizeIp',true);ga('send','pageview');}</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','G-T0B2C6W2ZH','auto');ga('set','anonymizeIp',true);ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><div class=logo-wrapper><a href=/ class=logo>小马哥</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/cloud-native>Cloud Native</a></li><li class=menu-item><a class=menu-item-link href=/devsecops>DevSecOps</a></li><li class=menu-item><a class=menu-item-link href=/aigc>AIGC</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>MCP、A2A 之外，AI 领域又新增一协议-AG-UI</h1><div class=post-meta><span class=post-time>2025-05-15</span><div class=post-category><a href=/categories/aigc/>AIGC</a></div><span class=more-meta>约 1719 字</span>
<span class=more-meta>预计阅读 4 分钟</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>文章目录</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#什么是-ag-ui>什么是 AG-UI</a></li><li><a href=#ag-ui-主要解决什么问题>AG-UI 主要解决什么问题</a></li><li><a href=#ag-ui-介绍>AG-UI 介绍</a><ul><li><a href=#核心组件>核心组件</a></li></ul></li><li><a href=#mcp-vs-a2a-vs-ag-ui>MCP vs A2A vs AG-UI</a></li></ul></li></ul></nav></div></div><div class=post-content><h2 id=什么是-ag-ui>什么是 AG-UI</h2><p>AG-UI（Agent User Interaction Protocol，智能体用户交互协议） 是一个开放的、轻量的、基于事件的协议，由 CopilotKit 公司发布，它通过标准 HTTP 或可选的二进制通道，以流式方式传输一系列 JSON 事件，主要用来对 AI agent 和前端应用程序的交互进行标准化。AG-UI 是由 CopilotKit 公司发布。</p><blockquote><p>CopilotKit 是一家成立于 2022 年的 AI 初创公司，聚焦在产品的 AI 助手打造上。官网的介绍是：<strong>AI Copilots for your product. Build fast, customize effortlessly.</strong> 官网地址为：https://www.copilotkit.ai/。</p></blockquote><h2 id=ag-ui-主要解决什么问题>AG-UI 主要解决什么问题</h2><p>CopilotKit 公司的人员解释，当前大多数 agent 都属于后端自动化工具，执行一些数据迁移、表单填写、内容总结一类的任务，这些 agent 在后台运行，对用户不可见。但是交互式 agent（比如 Cursor、Windsurf、Devin 等）已经实现了与用户的实时协同工作，它们也将带来海量的应用场景。这种情况下，就需要这些 agent 能够具备<strong>实时更新</strong>、<strong>工具编排</strong>、<strong>可共享的可变状态</strong>、<strong>安全边界控制</strong>以及<strong>前端同步</strong>等能力。为此他们构建并发布了 AG-UI 协议。</p><h2 id=ag-ui-介绍>AG-UI 介绍</h2><p><img src=images/ag-ui-overview.png alt=ag-ui-arch></p><ul><li><strong>Application</strong>：用户交互用到的应用程序（比如 chat 或其他任何 AI 应用）</li><li><strong>AG-UI 客户端</strong>：通用的通信客户端，诸如 <code>HttpAgent</code>，或用于连接现有协议的专用客户端</li><li><strong>Agent</strong>：后端用户处理用户请求并生成流式响应的 agent</li><li><strong>Secure Proxy</strong>：能够提供额外能力或作为安全代理的后端服务</li></ul><h3 id=核心组件>核心组件</h3><p>AG-UI 的核心组件包括<strong>协议层（Protocol Layer）、标准化 HTTP 客户端（Standard HTTP Client）、消息类型（Message Type）、运行智能体（Running Agent）、状态管理（State Management）、工具交接（Tools and Handoff）以及事件（Events）</strong>。</p><h4 id=协议层protocol-layer>协议层（Protocol Layer）</h4><p>AG-UI 协议层主要为 agent 通信提供一个灵活的基础。协议的核心让应用程序能够运行 agent 并且接受到事件流。</p><h4 id=标准-http-客户端>标准 HTTP 客户端</h4><p>AG-UI 提供了一个标准的 HTTP 客户端 <code>HttpAgent</code>，可用于连接任何支持 POST 请求的端点。该端点接收 <code>RunAgentInput</code> 类型的请求体，并返回 <code>BaseEvent</code> 对象的数据流。</p><p><code>HttpAgent</code> 支持 <strong>HTTP SSE (Server-Sent Events)</strong> 和 <strong>HTTP binary protocol</strong> 两种模式。</p><h4 id=消息类型>消息类型</h4><p>AG-UI 为 agent 通信的不同方面定义了一些事件策略，主要包括：</p><ul><li><strong>Lifecycle events</strong>：<code>RUN_STARTED</code>、<code>RUN_FINISHED</code>、<code>RUN_ERROR</code>、<code>STEP_STARTED</code>、<code>STEP_FINISHED</code></li><li><strong>Text message events</strong>：<code>TEXT_MESSAGE_START</code>、<code>TEXT_MESSAGE_CONTENT</code>、<code>TEXT_MESSAGE_END</code></li><li><strong>Tool call events</strong>：<code>TOOL_CALL_START</code>、<code>TOOL_CALL_ARGS</code>、<code>TOOL_CALL_END</code></li><li><strong>State management events</strong>：<code>STATE_SNAPSHOT</code>、<code>STATE_DELTA</code>、<code>MESSAGES_SNAPSHOT</code></li><li><strong>Special events</strong>：<code>RAW</code>、<code>CUSTOM</code></li></ul><h4 id=运行-agent>运行 Agent</h4><p>创建 agent 客户端实例并启用 agent。</p><h4 id=状态管理>状态管理</h4><p>AG-UI 通过专用事件对状态进行管理，目前提供的事件有：</p><ul><li><strong>STATE_SNAPSHOT</strong>：某一时刻的完整状态表示；</li><li><strong>STATE_DELTA</strong>：使用 JSON 补丁格式（RFC 6902）的增量状态变更；</li><li><strong>MESSAGES_SNAPSHOT</strong>：表示完整的对话历史；</li></ul><h4 id=工具和交接>工具和交接</h4><p>AG-UI 通过标准化事件来提供 agent 之间的任务移交的和工具的使用。</p><h4 id=事件>事件</h4><p>AG-UI 中的所有通信都是基于类型事件。每一个事件都继承自 <code>BaseEvent</code>，其借口如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>interface BaseEvent {
  type: EventType
  timestamp?: number
  rawEvent?: any
}
</code></pre></td></tr></table></div></div><h2 id=mcp-vs-a2a-vs-ag-ui>MCP vs A2A vs AG-UI</h2><p>去年底 Anthropic 发布了 MCP（Model Context Protocol），今年 Google 又发布了 A2A（Agent to Agent），都是面向这一轮 AI 发展的协议。</p><p>相比于 MCP 和 A2A，AG-UI 主要聚焦在智能体和用户（agent-user）的交互层上。它和 MCP 于 A2A 并不是竞争关系。这三者在 AI 生态中的作用不同：</p><ul><li>AG-UI：主要处理由用户（人）参与的交互以及流式更新用户界面；</li><li>A2A：主要促进智能体（agent-to-agent）之间的通信和协作；</li><li>MCP：主要解决跨不同模型之间工具调用的标准化和上下文处理问题；</li></ul><p>这三者互为补充。举个简单的例子：相同的 agent 可以通过 A2A 来跟其他的 agent 进行通信，同时又使用 AG-UI 来跟用户进行交互，另外还能通过 MCP 来进行工具的调用（tool call）。这三个协议，完成用户-Agent-LLM之间交互的标准化。</p><p>三个协议构成的 Agent 协议栈如下图所示：</p><p><img src=images/ag-ui-arch.webp alt=ag-ui-overview></p></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>马景贺（小马哥）</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2025-05-15</span></p></div><footer class=post-footer><div class=post-tags><a href=/tags/ai/>AI</a>
<a href=/tags/llm/>LLM</a></div><nav class=post-nav><a class=next href=/aigc/llm-work/><span class="next-text nav-default">图解 LLM（大语言模型）的工作原理</span>
<span class="next-text nav-mobile">下一篇</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=devops008@sina.com class="iconfont icon-email" title=email></a><a href=https://github.com/majinghe class="iconfont icon-github" title=github></a><a href=https://majinghe.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>由 <a class=hexo-link href=https://gohugo.io>Hugo</a> 强力驱动</span>
<span class=division>|</span>
<span class=theme-info>主题 -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020 -
2025<span class=heart><i class="iconfont icon-heart"></i></span><span>olOwOlo</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','G-T0B2C6W2ZH','auto');ga('set','anonymizeIp',true);ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>